{{ define "head" }}
<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
        background: linear-gradient(135deg, #EFF6FF 0%, #E0F2FE 50%, #D1FAE5 100%);
        min-height: 100vh;
    }

    .results-container {
        max-width: 1200px;
        margin: 60px auto;
        padding: 0 20px;
    }

    .results-header {
        text-align: center;
        margin-bottom: 60px;
    }

    .results-title {
        font-size: 3rem;
        background: linear-gradient(135deg, #0EA5E9, #14B8A6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 900;
        margin-bottom: 16px;
    }

    .results-subtitle {
        font-size: 1.2rem;
        color: #4B5563;
        margin-bottom: 32px;
    }

    .results-stats {
        display: flex;
        justify-content: center;
        gap: 40px;
        flex-wrap: wrap;
    }

    .stat-box {
        background: white;
        padding: 24px 32px;
        border-radius: 20px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        text-align: center;
    }

    .stat-number {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #0EA5E9, #14B8A6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .stat-label {
        font-size: 0.95rem;
        color: #6B7280;
        margin-top: 8px;
        font-weight: 600;
    }

    .results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 24px;
        margin-bottom: 40px;
    }

    .result-card {
        background: white;
        border-radius: 24px;
        padding: 32px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }

    .result-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
        border-color: #0EA5E9;
    }

    .result-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .result-card-title {
        font-size: 1.4rem;
        font-weight: 800;
        color: #2d3748;
        margin-bottom: 8px;
    }

    .result-card-date {
        font-size: 0.9rem;
        color: #9CA3AF;
        font-weight: 500;
    }

    .result-card-type {
        background: linear-gradient(135deg, #0EA5E9, #14B8A6);
        color: white;
        padding: 8px 16px;
        border-radius: 12px;
        font-size: 0.95rem;
        font-weight: 700;
        white-space: nowrap;
    }

    .result-card-actions {
        display: flex;
        gap: 12px;
        margin-top: 24px;
    }

    .btn-result {
        flex: 1;
        padding: 12px 24px;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-view {
        background: linear-gradient(135deg, #0EA5E9, #14B8A6);
        color: white;
    }

    .btn-view:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(14, 165, 233, 0.4);
    }

    .btn-delete {
        background: transparent;
        border: 2px solid #EF4444;
        color: #EF4444;
    }

    .btn-delete:hover {
        background: #EF4444;
        color: white;
    }

    .empty-state {
        text-align: center;
        padding: 80px 20px;
    }

    .empty-icon {
        font-size: 6rem;
        margin-bottom: 24px;
        opacity: 0.5;
    }

    .empty-title {
        font-size: 2rem;
        color: #4B5563;
        font-weight: 800;
        margin-bottom: 16px;
    }

    .empty-text {
        font-size: 1.2rem;
        color: #9CA3AF;
        margin-bottom: 32px;
    }

    .btn-start {
        display: inline-block;
        padding: 16px 40px;
        background: linear-gradient(135deg, #0EA5E9, #14B8A6);
        color: white;
        border-radius: 50px;
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: 800;
        transition: all 0.3s ease;
        box-shadow: 0 8px 24px rgba(14, 165, 233, 0.4);
    }

    .btn-start:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 32px rgba(14, 165, 233, 0.6);
    }

    .clear-all-btn {
        text-align: center;
        margin-top: 40px;
    }

    .btn-clear-all {
        padding: 14px 32px;
        background: transparent;
        border: 2px solid #EF4444;
        color: #EF4444;
        border-radius: 50px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-clear-all:hover {
        background: #EF4444;
        color: white;
    }

    @media (max-width: 768px) {
        .results-title {
            font-size: 2rem;
        }

        .results-grid {
            grid-template-columns: 1fr;
        }

        .result-card-actions {
            flex-direction: column;
        }

        .results-stats {
            gap: 20px;
        }

        .stat-box {
            padding: 20px 24px;
        }
    }
</style>
{{ end }}

{{ define "main" }}
<div class="results-container">
    <div class="results-header">
        <h1 class="results-title">ğŸ“‹ ë‚´ ê²°ê³¼ ë³´ê´€í•¨</h1>
        <p class="results-subtitle">ì§€ê¸ˆê¹Œì§€ ì§„í–‰í•œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>

        <div id="statsSection" class="results-stats" style="display: none;">
            <div class="stat-box">
                <div class="stat-number" id="totalTests">0</div>
                <div class="stat-label">ì™„ë£Œí•œ í…ŒìŠ¤íŠ¸</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="latestDate">-</div>
                <div class="stat-label">ìµœê·¼ í…ŒìŠ¤íŠ¸</div>
            </div>
        </div>
    </div>

    <div id="resultsContent">
        <!-- JavaScriptë¡œ ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
    </div>

    <div id="clearAllSection" class="clear-all-btn" style="display: none;">
        <a href="/compare-results/" class="btn-start" style="margin-right: 16px;">
            ğŸ¤ ì¹œêµ¬ì™€ ë¹„êµí•˜ê¸°
        </a>
        <button class="btn-clear-all" onclick="confirmClearAll()">
            ğŸ—‘ï¸ ëª¨ë“  ê²°ê³¼ ì‚­ì œ
        </button>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    loadResults();
    updateResultsBadge();
});

function loadResults() {
    const savedResults = JSON.parse(localStorage.getItem('test_results') || '{}');
    const resultsArray = Object.entries(savedResults).map(([id, data]) => ({
        id,
        ...data
    }));

    const resultsContent = document.getElementById('resultsContent');

    if (resultsArray.length === 0) {
        // ê²°ê³¼ê°€ ì—†ì„ ë•Œ
        resultsContent.innerHTML = `
            <div class="empty-state">
                <div class="empty-icon">ğŸ“­</div>
                <h2 class="empty-title">ì•„ì§ ì €ì¥ëœ ê²°ê³¼ê°€ ì—†ì–´ìš”</h2>
                <p class="empty-text">í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ ìë™ìœ¼ë¡œ ê²°ê³¼ê°€ ì €ì¥ë©ë‹ˆë‹¤</p>
                <a href="/" class="btn-start">í…ŒìŠ¤íŠ¸ ì‹œì‘í•˜ê¸° â†’</a>
            </div>
        `;
    } else {
        // ë‚ ì§œìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
        resultsArray.sort((a, b) => new Date(b.date) - new Date(a.date));

        // í†µê³„ ì—…ë°ì´íŠ¸
        document.getElementById('statsSection').style.display = 'flex';
        document.getElementById('totalTests').textContent = resultsArray.length;

        const latestDate = new Date(resultsArray[0].date);
        const daysAgo = Math.floor((new Date() - latestDate) / (1000 * 60 * 60 * 24));
        document.getElementById('latestDate').textContent = daysAgo === 0 ? 'ì˜¤ëŠ˜' : `${daysAgo}ì¼ ì „`;

        // ê²°ê³¼ ì¹´ë“œ ìƒì„±
        const cardsHTML = resultsArray.map(result => `
            <div class="result-card" data-id="${result.id}">
                <div class="result-card-header">
                    <div>
                        <h3 class="result-card-title">${result.title || 'í…ŒìŠ¤íŠ¸ ê²°ê³¼'}</h3>
                        <p class="result-card-date">${formatDate(result.date)}</p>
                    </div>
                    <div class="result-card-type">${result.resultType || 'ê²°ê³¼'}</div>
                </div>

                <div class="result-card-actions">
                    <button class="btn-result btn-view" onclick="viewResult('${result.id}')">
                        ğŸ‘€ ë‹¤ì‹œ ë³´ê¸°
                    </button>
                    <button class="btn-result btn-delete" onclick="deleteResult('${result.id}')">
                        ğŸ—‘ï¸ ì‚­ì œ
                    </button>
                </div>
            </div>
        `).join('');

        resultsContent.innerHTML = `<div class="results-grid">${cardsHTML}</div>`;
        document.getElementById('clearAllSection').style.display = 'block';
    }
}

function formatDate(dateString) {
    const date = new Date(dateString);
    const now = new Date();
    const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));

    if (diffDays === 0) return 'ì˜¤ëŠ˜';
    if (diffDays === 1) return 'ì–´ì œ';
    if (diffDays < 7) return `${diffDays}ì¼ ì „`;
    if (diffDays < 30) return `${Math.floor(diffDays / 7)}ì£¼ ì „`;
    if (diffDays < 365) return `${Math.floor(diffDays / 30)}ê°œì›” ì „`;
    return `${Math.floor(diffDays / 365)}ë…„ ì „`;
}

function viewResult(testId) {
    // í…ŒìŠ¤íŠ¸ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
    window.location.href = `/tests/${testId}/`;
}

function deleteResult(testId) {
    if (confirm('ì •ë§ ì´ ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const savedResults = JSON.parse(localStorage.getItem('test_results') || '{}');
        delete savedResults[testId];
        localStorage.setItem('test_results', JSON.stringify(savedResults));

        loadResults();
        updateResultsBadge();
    }
}

function confirmClearAll() {
    if (confirm('ëª¨ë“  ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
        if (confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            localStorage.removeItem('test_results');
            loadResults();
            updateResultsBadge();
        }
    }
}

function updateResultsBadge() {
    const savedResults = JSON.parse(localStorage.getItem('test_results') || '{}');
    const count = Object.keys(savedResults).length;

    const badge = document.getElementById('resultsBadge');
    if (badge) {
        if (count > 0) {
            badge.textContent = count;
            badge.style.display = 'block';
        } else {
            badge.style.display = 'none';
        }
    }
}
</script>
{{ end }}
