{{ define "head" }}
<link rel="stylesheet" href="/css/fortune.css">
<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
        background: linear-gradient(180deg, #0f172a 0%, #1e1b4b 50%, #312e81 100%);
        min-height: 100vh;
    }

    /* ì§ˆë¬¸ ì…ë ¥ í™”ë©´ */
    .question-container {
        max-width: 800px;
        margin: 80px auto;
        padding: 60px 40px;
        text-align: center;
        background: linear-gradient(135deg, rgba(30, 27, 75, 0.9), rgba(49, 46, 129, 0.9));
        border-radius: 32px;
        border: 2px solid rgba(251, 191, 36, 0.3);
    }

    .question-title {
        font-size: 2.5rem;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 20px;
        font-weight: 900;
    }

    .question-subtitle {
        color: #cbd5e1;
        font-size: 1.15rem;
        margin-bottom: 40px;
        line-height: 1.8;
    }

    .question-input {
        width: 100%;
        max-width: 600px;
        padding: 20px;
        font-size: 1.1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(251, 191, 36, 0.3);
        border-radius: 16px;
        color: #fbbf24;
        text-align: center;
        margin: 0 auto 30px;
        box-sizing: border-box;
    }

    .question-input::placeholder {
        color: rgba(251, 191, 36, 0.5);
    }

    .question-input:focus {
        outline: none;
        border-color: #fbbf24;
        box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
    }

    .start-button {
        padding: 18px 60px;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        color: #1e1b4b;
        border: none;
        border-radius: 50px;
        font-size: 1.2rem;
        font-weight: 800;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 20px rgba(251, 191, 36, 0.4);
    }

    .start-button:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 30px rgba(251, 191, 36, 0.6);
    }

    /* ì¹´ë“œ ì„ íƒ í™”ë©´ */
    .tarot-selection-container {
        max-width: 1000px;
        margin: 60px auto;
        padding: 60px 40px;
        text-align: center;
    }

    .tarot-title {
        font-size: 2rem;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 16px;
        font-weight: 900;
    }

    .user-question {
        color: #fbbf24;
        font-size: 1.4rem;
        margin-bottom: 32px;
        font-weight: 700;
        font-style: italic;
    }

    .tarot-subtitle {
        color: #cbd5e1;
        font-size: 1.1rem;
        margin-bottom: 48px;
        line-height: 1.8;
    }

    .tarot-cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 20px;
        max-width: 800px;
        margin: 0 auto;
    }

    .tarot-card {
        aspect-ratio: 2/3;
        background: linear-gradient(135deg, #312e81, #1e1b4b);
        border: 2px solid rgba(251, 191, 36, 0.3);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .tarot-card::before {
        content: 'ğŸƒ';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 3rem;
        opacity: 0.5;
    }

    .tarot-card:hover {
        transform: translateY(-10px) scale(1.05);
        border-color: #fbbf24;
        box-shadow: 0 10px 30px rgba(251, 191, 36, 0.4);
    }

    /* ê²°ê³¼ í™”ë©´ */
    .result-container {
        max-width: 800px;
        margin: 80px auto;
        padding: 60px 40px;
        text-align: center;
        background: linear-gradient(135deg, rgba(30, 27, 75, 0.9), rgba(49, 46, 129, 0.9));
        border-radius: 32px;
        border: 2px solid rgba(251, 191, 36, 0.3);
    }

    .answer-badge {
        font-size: 6rem;
        margin-bottom: 20px;
        filter: drop-shadow(0 4px 20px rgba(251, 191, 36, 0.5));
        animation: answerReveal 0.6s ease-out;
    }

    @keyframes answerReveal {
        0% { opacity: 0; transform: scale(0.3); }
        50% { transform: scale(1.1); }
        100% { opacity: 1; transform: scale(1); }
    }

    .answer-text {
        font-size: 4rem;
        font-weight: 900;
        margin-bottom: 24px;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .answer-text.yes {
        background: linear-gradient(135deg, #10b981, #059669);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .answer-text.no {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .answer-text.maybe {
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .card-info {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1));
        border: 2px solid rgba(251, 191, 36, 0.3);
        border-radius: 20px;
        padding: 30px;
        margin: 40px 0;
    }

    .card-name {
        font-size: 1.8rem;
        color: #fbbf24;
        font-weight: 800;
        margin-bottom: 12px;
    }

    .card-meaning {
        font-size: 1.1rem;
        color: #e2e8f0;
        line-height: 1.8;
        margin-bottom: 20px;
    }

    .advice-section {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(245, 158, 11, 0.15));
        border-radius: 20px;
        padding: 30px;
        margin-top: 30px;
    }

    .advice-title {
        font-size: 1.4rem;
        color: #fbbf24;
        font-weight: 800;
        margin-bottom: 16px;
    }

    .advice-content {
        font-size: 1.05rem;
        color: #e2e8f0;
        line-height: 1.8;
    }

    @media (max-width: 768px) {
        .question-title, .tarot-title {
            font-size: 2rem;
        }

        .answer-text {
            font-size: 3rem;
        }

        .answer-badge {
            font-size: 4.5rem;
        }

        .question-container, .result-container {
            padding: 40px 20px;
        }
    }
</style>
{{ end }}

{{ define "main" }}
<div class="fortune-page" style="position: relative; z-index: 1; padding-bottom: 80px;">
    <div style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">

        <!-- ì§ˆë¬¸ ì…ë ¥ ì„¹ì…˜ -->
        <div id="questionSection" class="question-container">
            <h2 class="question-title">âœ¨ ì˜ˆìŠ¤/ë…¸ íƒ€ë¡œ</h2>
            <p class="question-subtitle">
                ê³ ë¯¼ë˜ëŠ” ì§ˆë¬¸ì´ ìˆë‚˜ìš”?<br>
                íƒ€ë¡œ ì¹´ë“œê°€ ëª…í™•í•œ ë‹µì„ ë“œë¦½ë‹ˆë‹¤
            </p>

            <input type="text"
                   id="userQuestion"
                   class="question-input"
                   placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)"
                   maxlength="100">

            <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 30px;">
                ğŸ’­ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì§€ ì•Šì•„ë„ ë§ˆìŒì†ìœ¼ë¡œ ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤
            </div>

            <button class="start-button" onclick="startReading()">
                ğŸ”® ì¹´ë“œ ì„ íƒí•˜ê¸°
            </button>
        </div>

        <!-- ì¹´ë“œ ì„ íƒ ì„¹ì…˜ -->
        <div id="selectionSection" class="tarot-selection-container" style="display: none;">
            <h2 class="tarot-title">ğŸ´ ì¹´ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”</h2>
            <div id="questionDisplay" class="user-question"></div>
            <p class="tarot-subtitle">
                ë§ˆìŒì„ ì§‘ì¤‘í•˜ê³  ì§ê´€ì„ ë”°ë¼ ì¹´ë“œ í•œ ì¥ì„ ì„ íƒí•˜ì„¸ìš”
            </p>

            <div class="tarot-cards-grid" id="tarotCards">
                <!-- ì¹´ë“œê°€ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- ê²°ê³¼ ì„¹ì…˜ -->
        <div id="resultSection" class="result-container" style="display: none;">
            <div id="answerBadge" class="answer-badge"></div>
            <div id="answerText" class="answer-text"></div>

            <div class="card-info">
                <div id="cardName" class="card-name"></div>
                <div id="cardMeaning" class="card-meaning"></div>
            </div>

            <div class="advice-section">
                <div class="advice-title">ğŸ’¡ ì¡°ì–¸</div>
                <div id="adviceContent" class="advice-content"></div>
            </div>

            <!-- ë‹¤ì‹œí•˜ê¸° -->
            <div style="margin-top: 50px; display: flex; justify-content: center; gap: 16px; flex-wrap: wrap;">
                <button onclick="location.reload()"
                        style="padding: 16px 40px; background: transparent; color: #fbbf24; border: 2px solid #fbbf24; border-radius: 50px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease;">
                    ğŸ”„ ë‹¤ì‹œ ë³´ê¸°
                </button>
                <button onclick="shareResult()"
                        style="padding: 16px 40px; background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #1e1b4b; border: none; border-radius: 50px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 16px rgba(251, 191, 36, 0.3);">
                    ğŸ’¬ ê²°ê³¼ ê³µìœ í•˜ê¸°
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    // íƒ€ë¡œ ì¹´ë“œì™€ YES/NO ë§¤í•‘
    const yesNoTarot = [
        { id: 0, name: 'ë°”ë³´', answer: 'YES', badge: 'âœ…', advice: 'ìƒˆë¡œìš´ ì‹œë„ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”. ì§€ê¸ˆì´ ë°”ë¡œ ê·¸ ë•Œì…ë‹ˆë‹¤!' },
        { id: 1, name: 'ë§ˆë²•ì‚¬', answer: 'YES', badge: 'âœ…', advice: 'ë‹¹ì‹ ì€ ì´ë¯¸ í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ìì‹ ê°ì„ ê°€ì§€ì„¸ìš”!' },
        { id: 2, name: 'ì—¬ì‚¬ì œ', answer: 'MAYBE', badge: 'ğŸ¤”', advice: 'ì¡°ê¸ˆ ë” ì‹œê°„ì„ ë‘ê³  ë‚´ë©´ì˜ ëª©ì†Œë¦¬ì— ê·€ ê¸°ìš¸ì´ì„¸ìš”.' },
        { id: 3, name: 'ì—¬í™©ì œ', answer: 'YES', badge: 'âœ…', advice: 'í’ìš”ë¡œìš´ ê²°ê³¼ë¥¼ ê¸°ëŒ€í•´ë„ ì¢‹ìŠµë‹ˆë‹¤. ìì‹  ìˆê²Œ ì§„í–‰í•˜ì„¸ìš”!' },
        { id: 4, name: 'í™©ì œ', answer: 'YES', badge: 'âœ…', advice: 'ê³„íšì ìœ¼ë¡œ ì ‘ê·¼í•œë‹¤ë©´ ì„±ê³µí•  ê²ƒì…ë‹ˆë‹¤.' },
        { id: 5, name: 'êµí™©', answer: 'MAYBE', badge: 'ğŸ¤”', advice: 'ì¡°ì–¸ì„ êµ¬í•˜ê±°ë‚˜ ì „í†µì ì¸ ë°©ë²•ì„ ê³ ë ¤í•´ë³´ì„¸ìš”.' },
        { id: 6, name: 'ì—°ì¸', answer: 'YES', badge: 'âœ…', advice: 'ë§ˆìŒì´ ì´ë„ëŠ” ëŒ€ë¡œ ë”°ë¥´ì„¸ìš”. ì¢‹ì€ ì„ íƒì´ ë  ê²ƒì…ë‹ˆë‹¤.' },
        { id: 7, name: 'ì „ì°¨', answer: 'YES', badge: 'âœ…', advice: 'ê°•í•œ ì˜ì§€ë¡œ ë°€ê³  ë‚˜ê°€ì„¸ìš”. ìŠ¹ë¦¬ê°€ ê°€ê¹Œì´ ìˆìŠµë‹ˆë‹¤!' },
        { id: 8, name: 'í˜', answer: 'YES', badge: 'âœ…', advice: 'ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ê¾¸ì¤€íˆ ë‚˜ì•„ê°€ë©´ ì´ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
        { id: 9, name: 'ì€ë‘”ì', answer: 'NO', badge: 'âŒ', advice: 'ì•„ì§ì€ ë•Œê°€ ì•„ë‹™ë‹ˆë‹¤. ë” ë§ì€ ì¤€ë¹„ì™€ ì„±ì°°ì´ í•„ìš”í•©ë‹ˆë‹¤.' },
        { id: 10, name: 'ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´', answer: 'MAYBE', badge: 'ğŸ¤”', advice: 'ìš´ëª…ì˜ íë¦„ì— ë§¡ê¸°ì„¸ìš”. ì‹œê°„ì´ ë‹µì„ ì¤„ ê²ƒì…ë‹ˆë‹¤.' },
        { id: 11, name: 'ì •ì˜', answer: 'YES', badge: 'âœ…', advice: 'ê³µì •í•œ ê²°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§„ì‹¤ì„ ë”°ë¥´ì„¸ìš”.' },
        { id: 12, name: 'ë§¤ë‹¬ë¦° ì‚¬ëŒ', answer: 'NO', badge: 'âŒ', advice: 'ì§€ê¸ˆì€ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ê´€ì ì´ í•„ìš”í•©ë‹ˆë‹¤.' },
        { id: 13, name: 'ì£½ìŒ', answer: 'MAYBE', badge: 'ğŸ¤”', advice: 'í° ë³€í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤. ê³¼ê±°ë¥¼ ë†“ì•„ì£¼ê³  ìƒˆë¡­ê²Œ ì‹œì‘í•˜ì„¸ìš”.' },
        { id: 14, name: 'ì ˆì œ', answer: 'MAYBE', badge: 'ğŸ¤”', advice: 'ê· í˜•ì„ ì°¾ìœ¼ì„¸ìš”. ê·¹ë‹¨ì ì¸ ì„ íƒì€ í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.' },
        { id: 15, name: 'ì•…ë§ˆ', answer: 'NO', badge: 'âŒ', advice: 'ë¬´ì–¸ê°€ì— ì–½ë§¤ì—¬ ìˆì§€ ì•Šë‚˜ìš”? ìŠ¤ìŠ¤ë¡œë¥¼ ììœ ë¡­ê²Œ í•˜ì„¸ìš”.' },
        { id: 16, name: 'íƒ‘', answer: 'NO', badge: 'âŒ', advice: 'ì˜ˆìƒì¹˜ ëª»í•œ ì–´ë ¤ì›€ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì¬ê³ í•˜ì„¸ìš”.' },
        { id: 17, name: 'ë³„', answer: 'YES', badge: 'âœ…', advice: 'í¬ë§ì„ ê°€ì§€ì„¸ìš”. ê¸ì •ì ì¸ ê²°ê³¼ê°€ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤!' },
        { id: 18, name: 'ë‹¬', answer: 'NO', badge: 'âŒ', advice: 'ë¶ˆí™•ì‹¤ì„±ì´ ìˆìŠµë‹ˆë‹¤. ë” ëª…í™•í•´ì§ˆ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì„¸ìš”.' },
        { id: 19, name: 'íƒœì–‘', answer: 'YES', badge: 'âœ…', advice: 'ì ˆëŒ€ì ìœ¼ë¡œ YES! ë°ì€ ë¯¸ë˜ê°€ í¼ì³ì§‘ë‹ˆë‹¤!' },
        { id: 20, name: 'ì‹¬íŒ', answer: 'MAYBE', badge: 'ğŸ¤”', advice: 'ê³¼ê±°ë¥¼ ì •ë¦¬í•˜ê³  ìƒˆë¡œìš´ ì‹œì‘ì„ ì¤€ë¹„í•˜ì„¸ìš”.' },
        { id: 21, name: 'ì„¸ê³„', answer: 'YES', badge: 'âœ…', advice: 'ì™„ë²½í•œ íƒ€ì´ë°ì…ë‹ˆë‹¤. ìì‹  ìˆê²Œ ë‚˜ì•„ê°€ì„¸ìš”!' }
    ];

    let userQuestion = '';
    let selectedCard = null;

    // ì¹´ë“œ ì„ íƒ ì‹œì‘
    function startReading() {
        userQuestion = document.getElementById('userQuestion').value.trim();

        document.getElementById('questionSection').style.display = 'none';
        document.getElementById('selectionSection').style.display = 'block';

        if (userQuestion) {
            document.getElementById('questionDisplay').textContent = `"${userQuestion}"`;
        } else {
            document.getElementById('questionDisplay').textContent = '"ë§ˆìŒì† ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì„ ì°¾ì•„ë³´ì„¸ìš”"';
        }

        createCardGrid();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ì¹´ë“œ ê·¸ë¦¬ë“œ ìƒì„±
    function createCardGrid() {
        const grid = document.getElementById('tarotCards');
        grid.innerHTML = '';

        // 7ì¥ë§Œ í‘œì‹œ (ê°„ë‹¨í•˜ê²Œ)
        const cardCount = 7;
        for (let i = 0; i < cardCount; i++) {
            const card = document.createElement('div');
            card.className = 'tarot-card';
            card.onclick = () => selectCard();
            grid.appendChild(card);
        }
    }

    // ì¹´ë“œ ì„ íƒ ë° ê²°ê³¼ í‘œì‹œ
    function selectCard() {
        // ëœë¤ ì¹´ë“œ ì„ íƒ
        const randomIndex = Math.floor(Math.random() * yesNoTarot.length);
        selectedCard = yesNoTarot[randomIndex];

        setTimeout(() => {
            showResult();
        }, 300);
    }

    // ê²°ê³¼ í‘œì‹œ
    function showResult() {
        const { name, answer, badge, advice } = selectedCard;

        document.getElementById('answerBadge').textContent = badge;
        document.getElementById('answerText').textContent = answer;
        document.getElementById('answerText').className = `answer-text ${answer.toLowerCase()}`;
        document.getElementById('cardName').textContent = `${badge} ${name}`;

        const meanings = {
            'YES': 'ê¸ì •ì ì¸ ì‹ í˜¸ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì€ YESì…ë‹ˆë‹¤.',
            'NO': 'ì§€ê¸ˆì€ ì•„ë‹ˆë¼ëŠ” ì‹ í˜¸ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì€ NOì…ë‹ˆë‹¤.',
            'MAYBE': 'í™•ì‹¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë” ë§ì€ ê³ ë¯¼ì´ë‚˜ ì‹œê°„ì´ í•„ìš”í•©ë‹ˆë‹¤.'
        };

        document.getElementById('cardMeaning').textContent = meanings[answer];
        document.getElementById('adviceContent').textContent = advice;

        document.getElementById('selectionSection').style.display = 'none';
        document.getElementById('resultSection').style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // GA4 ì´ë²¤íŠ¸
        if (typeof gtag !== 'undefined') {
            gtag('event', 'yes_no_tarot_complete', {
                card: name,
                answer: answer,
                has_question: userQuestion !== ''
            });
        }
    }

    // ê²°ê³¼ ê³µìœ 
    function shareResult() {
        const text = `ì˜ˆìŠ¤/ë…¸ íƒ€ë¡œ ê²°ê³¼: ${selectedCard.answer}\n${selectedCard.name} - ${selectedCard.advice}\n\n${window.location.href}`;

        if (navigator.share) {
            navigator.share({
                title: 'ì˜ˆìŠ¤/ë…¸ íƒ€ë¡œ ìš´ì„¸',
                text: text
            });
        } else {
            navigator.clipboard.writeText(text);
            alert('ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
    }
</script>
{{ end }}
