{{ define "head" }}
<!-- Dynamic OG Tags for Result Sharing -->
<meta property="og:type" content="article">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:title" content="{{ .Title }}">
<meta property="og:description" content="{{ .Params.ogDescription }}">
<meta property="og:image" content="{{ .Site.BaseURL }}images/{{ .Params.ogImage }}">
<meta property="og:site_name" content="{{ .Site.Title }}">
<meta property="og:locale" content="ko_KR">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ .Title }}">
<meta name="twitter:description" content="{{ .Params.ogDescription }}">
<meta name="twitter:image" content="{{ .Site.BaseURL }}images/{{ .Params.ogImage }}">

<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
    }

    .result-container {
        max-width: 800px;
        margin: 40px auto;
        padding: 0 20px;
    }

    .result-card {
        background: white;
        padding: 50px;
        border-radius: 20px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        text-align: center;
    }

    .result-badge {
        font-size: 5rem;
        margin-bottom: 20px;
    }

    .result-title {
        font-size: 2.2rem;
        font-weight: 700;
        color: #333;
        margin-bottom: 10px;
    }

    .result-subtitle {
        font-size: 1.2rem;
        color: #667eea;
        margin-bottom: 30px;
        font-weight: 600;
    }

    .result-rarity {
        margin: 15px 0;
        padding: 10px 20px;
        background: linear-gradient(135deg, #667eea33, #764ba233);
        border-radius: 15px;
        display: inline-block;
    }

    .result-rarity span {
        font-size: 14px;
        color: #667eea;
        font-weight: bold;
    }

    .result-description {
        font-size: 1.1rem;
        color: #666;
        line-height: 1.8;
        margin-bottom: 30px;
    }

    .result-traits {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 25px;
        text-align: left;
    }

    .result-traits h3 {
        font-size: 1.3rem;
        color: #333;
        margin-bottom: 15px;
        text-align: center;
    }

    .result-traits ul {
        list-style: none;
        padding: 0;
    }

    .result-traits li {
        font-size: 1rem;
        color: #666;
        padding: 10px 0;
        border-bottom: 1px solid #e0e0e0;
    }

    .result-traits li:last-child {
        border-bottom: none;
    }

    .result-section {
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 15px;
        text-align: left;
    }

    .result-section.love-language {
        border-left: 4px solid #667eea;
    }

    .result-section.compatibility {
        border-left: 4px solid #764ba2;
    }

    .result-section.recommendation {
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
    }

    .result-section h3 {
        margin-bottom: 10px;
        font-size: 1.3rem;
        color: #333;
    }

    .result-section p {
        color: #666;
        line-height: 1.7;
        font-size: 1rem;
    }

    /* 공유 버튼 스타일 */
    .share-section-inline {
        margin-top: 40px;
        padding-top: 30px;
        border-top: 2px solid #f0f0f0;
    }

    .share-section-inline h4 {
        text-align: center;
        font-size: 1.3rem;
        color: #333;
        margin-bottom: 20px;
    }

    .share-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
    }

    .btn-share {
        flex: 1;
        min-width: 200px;
        max-width: 250px;
        padding: 15px 25px;
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all 0.3s ease;
    }

    .btn-share:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .btn-facebook {
        background: #1877f2;
    }

    .btn-copy {
        background: #667eea;
    }

    .action-buttons {
        margin-top: 30px;
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
    }

    .btn-action {
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: 700;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .btn-secondary {
        background: white;
        color: #667eea;
        border: 2px solid #667eea;
    }

    .btn-action:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    /* 반응형 */
    @media (max-width: 768px) {
        .result-card {
            padding: 25px;
        }

        .result-title {
            font-size: 1.8rem;
        }

        .result-badge {
            font-size: 4rem;
        }

        .share-buttons {
            flex-direction: column;
        }

        .btn-share {
            max-width: 100%;
        }
    }
</style>
{{ end }}

{{ define "main" }}
<div class="result-container">
    <div class="result-card">
        <!-- Result Badge -->
        <div class="result-badge">{{ .Params.badge }}</div>

        <!-- Result Title -->
        <h1 class="result-title">{{ .Params.resultTitle }}</h1>
        <p class="result-subtitle">{{ .Params.subtitle }}</p>

        <!-- Rarity -->
        {{ if .Params.rarity }}
        <div class="result-rarity">
            <span>✨ 희소성: 전체의 {{ .Params.rarity }}%</span>
        </div>
        {{ end }}

        <!-- Description -->
        <div class="result-description">
            {{ .Params.description }}
        </div>

        <!-- Traits -->
        {{ if .Params.traits }}
        <div class="result-traits">
            <h3>주요 특징</h3>
            <ul>
                {{ range .Params.traits }}
                <li>{{ . }}</li>
                {{ end }}
            </ul>
        </div>
        {{ end }}

        <!-- Love Language -->
        {{ if .Params.loveLanguage }}
        <div class="result-section love-language">
            <h3>💕 나의 사랑의 언어</h3>
            <p>{{ .Params.loveLanguage }}</p>
        </div>
        {{ end }}

        <!-- Compatibility -->
        {{ if .Params.compatibility }}
        <div class="result-section compatibility">
            <h3>💑 잘 맞는 유형</h3>
            <p>{{ .Params.compatibility }}</p>
        </div>
        {{ end }}

        <!-- Recommendation -->
        {{ if .Params.recommendation }}
        <div class="result-section recommendation">
            <h3>💡 추천</h3>
            <p>{{ .Params.recommendation }}</p>
        </div>
        {{ end }}

        <!-- Share Buttons -->
        <div class="share-section-inline">
            <h4>💬 결과를 친구에게 공유하기</h4>
            <div class="share-buttons">
                <button class="btn-share btn-facebook" onclick="shareFacebook()">
                    <span style="font-size: 1.3rem;">📘</span> 페이스북
                </button>
                <button class="btn-share btn-copy" onclick="copyLink()">
                    <span style="font-size: 1.3rem;">🔗</span> <span class="copy-text">링크 복사</span>
                </button>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <a href="{{ .Params.testUrl }}" class="btn-action btn-primary">
                나도 테스트하기 ▶
            </a>
            <a href="/" class="btn-action btn-secondary">
                다른 테스트 보기
            </a>
        </div>
    </div>
</div>

<script>
    // 페이스북 공유
    function shareFacebook() {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent('{{ .Params.ogDescription }}');
        const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`;
        window.open(shareUrl, '_blank', 'width=600,height=400');
    }

    // 링크 복사
    function copyLink() {
        const url = window.location.href;
        const shareText = `{{ .Params.ogDescription }}\n\n${url}`;

        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(shareText).then(() => {
                const copyBtn = document.querySelector('.copy-text');
                if (copyBtn) {
                    copyBtn.textContent = '복사 완료!';
                    setTimeout(() => {
                        copyBtn.textContent = '링크 복사';
                    }, 2000);
                }
            }).catch(err => {
                console.error('복사 실패:', err);
                fallbackCopyLink(shareText);
            });
        } else {
            fallbackCopyLink(shareText);
        }
    }

    // 폴백 복사 함수
    function fallbackCopyLink(text) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        document.body.appendChild(textArea);
        textArea.select();

        try {
            document.execCommand('copy');
            const copyBtn = document.querySelector('.copy-text');
            if (copyBtn) {
                copyBtn.textContent = '복사 완료!';
                setTimeout(() => {
                    copyBtn.textContent = '링크 복사';
                }, 2000);
            }
        } catch (err) {
            console.error('복사 실패:', err);
            alert('링크 복사에 실패했습니다.');
        }

        document.body.removeChild(textArea);
    }
</script>
{{ end }}
