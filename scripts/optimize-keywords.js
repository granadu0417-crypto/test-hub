const fs = require('fs');
const path = require('path');

// í‚¤ì›Œë“œ ê°œì„  ê·œì¹™
const optimizationRules = {
  // "ë¬´ë£Œ" ì¶”ê°€ ìœ„ì¹˜
  addFree: (desc) => {
    if (desc.includes('ë¬´ë£Œ')) return desc;
    // "ì‹¬ë¦¬í…ŒìŠ¤íŠ¸" ë‹¤ìŒì´ë‚˜ "í…ŒìŠ¤íŠ¸" ì•ì— ì¶”ê°€
    if (desc.includes('ì‹¬ë¦¬í…ŒìŠ¤íŠ¸')) {
      return desc.replace('ì‹¬ë¦¬í…ŒìŠ¤íŠ¸', 'ë¬´ë£Œ ì‹¬ë¦¬í…ŒìŠ¤íŠ¸');
    }
    // ì²« ë¬¸ì¥ì— ì¶”ê°€
    return `ë¬´ë£Œ ${desc}`;
  },

  // "2025ë…„ ìµœì‹ " ì¶”ê°€
  addYear: (desc) => {
    if (desc.includes('2025')) return desc;
    // ì„¤ëª… ì•ë¶€ë¶„ì— ìì—°ìŠ¤ëŸ½ê²Œ ì¶”ê°€
    return `2025ë…„ ìµœì‹ ! ${desc}`;
  },

  // ì†Œìš” ì‹œê°„ ì¶”ê°€
  addDuration: (desc, duration) => {
    if (desc.includes('ë¶„') || desc.includes('ë¹ ë¥¸')) return desc;
    // ëë¶€ë¶„ì— ì¶”ê°€
    return `${desc} ${duration || '2-3ë¶„'} ì†Œìš”`;
  }
};

// ê°œë³„ í…ŒìŠ¤íŠ¸ë³„ ë§ì¶¤ ìµœì í™”
const customOptimizations = {
  'animal-bti.md': {
    newDescription: '2025ë…„ ìµœì‹ ! ë‚˜ë¥¼ ë‹®ì€ ë™ë¬¼ì€? 12ê°€ì§€ ë™ë¬¼ ì¤‘ ë‚˜ì˜ ì„±ê²©ê³¼ ë”± ë§ëŠ” ë™ë¬¼ ì°¾ê¸°. ë¬´ë£Œ ë™ë¬¼BTI í…ŒìŠ¤íŠ¸ë¡œ ë‚˜ì˜ ì•¼ìƒ ë³¸ëŠ¥ì„ ì¬ë¯¸ìˆê²Œ ì•Œì•„ë³´ì„¸ìš”! ì¹œêµ¬ë“¤ê³¼ ê³µìœ  í•„ìˆ˜ - 2-3ë¶„ ì™„ì„±'
  },
  'burnout.md': {
    newDescription: '2025ë…„ ë²ˆì•„ì›ƒ ìê°€ì§„ë‹¨ í…ŒìŠ¤íŠ¸. í˜„ì¬ ë‚˜ì˜ ì‹¬ë¦¬ ìƒíƒœì™€ ë²ˆì•„ì›ƒ ìˆ˜ì¤€ì„ ì •í™•í•˜ê²Œ ì¸¡ì •í•˜ì„¸ìš”. ë¬´ë£Œ ì‹¬ë¦¬ í…ŒìŠ¤íŠ¸ë¡œ ë¹ ë¥´ê²Œ í™•ì¸í•˜ê³  íšŒë³µ ë°©ë²•ê¹Œì§€ ì œì‹œ - 2ë¶„ ì™„ì„±'
  },
  'career-aptitude.md': {
    newDescription: '2025ë…„ ìµœì‹  ì§ì—… ì ì„± í…ŒìŠ¤íŠ¸! ë‚˜ì—ê²Œ ë”± ë§ëŠ” ì§ì—…ê³¼ ì§„ë¡œë¥¼ ì°¾ì•„ë³´ì„¸ìš”. 12ê°€ì§€ ì§ˆë¬¸ìœ¼ë¡œ ë‚˜ì˜ ê°•ì ê³¼ ì„±í–¥ì„ ë¶„ì„í•˜ëŠ” ë¬´ë£Œ ì»¤ë¦¬ì–´ í…ŒìŠ¤íŠ¸ - 3ë¶„ ì™„ì„±'
  },
  'character-bti.md': {
    newDescription: '2025ë…„ ì¸ê¸° ìºë¦­í„°BTI! ë‚˜ëŠ” ì£¼ì¸ê³µ? ì•…ë‹¹? 10ê°€ì§€ ìºë¦­í„° ìœ í˜• ì¤‘ ë‚˜ì˜ ì„±ê²©ì„ ëŒ€í‘œí•˜ëŠ” ìºë¦­í„° ì°¾ê¸°. ë¬´ë£Œ ì¬ë¯¸ í…ŒìŠ¤íŠ¸ë¡œ ì¹œêµ¬ì™€ ë¹„êµí•´ë³´ì„¸ìš” - 2ë¶„ ì™„ì„±'
  },
  'color-bti.md': {
    newDescription: '2025ë…„ ìµœì‹  ìƒ‰ê¹”BTI í…ŒìŠ¤íŠ¸! ë‚˜ë¥¼ í‘œí˜„í•˜ëŠ” ìƒ‰ì€? ì‹¬ë¦¬í•™ ê¸°ë°˜ 10ê°€ì§€ ì»¬ëŸ¬ ì¤‘ ë‚˜ì˜ ì„±ê²© ìƒ‰ê¹” ì°¾ê¸°. ë¬´ë£Œ ì‹¬ë¦¬ í…ŒìŠ¤íŠ¸ë¡œ ë‚˜ì˜ ì§„ì§œ ìƒ‰ê¹”ì„ ì•Œì•„ë³´ì„¸ìš” - 2-3ë¶„ ì™„ì„±'
  },
  'empathy.md': {
    newDescription: '2025ë…„ ê³µê°ëŠ¥ë ¥ ì¸¡ì • í…ŒìŠ¤íŠ¸! ë‚˜ì˜ ê³µê° ì§€ìˆ˜ëŠ” ëª‡ ì ? ì¸ì§€ì /ê°ì •ì  ê³µê° ëŠ¥ë ¥ì„ ì‹¬ë¦¬í•™ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” ë¬´ë£Œ í…ŒìŠ¤íŠ¸ - 3ë¶„ ì™„ì„±'
  },
  'food-bti.md': {
    newDescription: '2025ë…„ ì¸ê¸° ìŒì‹BTI! ë‚˜ë¥¼ ë‹®ì€ ìŒì‹ì€? 12ê°€ì§€ ìŒì‹ ì¤‘ ë‚˜ì˜ ì„±ê²©ê³¼ ìŠ¤íƒ€ì¼ì„ ëŒ€í‘œí•˜ëŠ” ìŒì‹ ì°¾ê¸°. ë¬´ë£Œ ì¬ë¯¸ í…ŒìŠ¤íŠ¸ë¡œ ì¹œêµ¬ë“¤ê³¼ ê³µìœ  í•„ìˆ˜ - 2ë¶„ ì™„ì„±'
  },
  'love-language.md': {
    newDescription: 'ë¬´ë£Œ ì• ì •í‘œí˜„ ë°©ì‹ í…ŒìŠ¤íŠ¸! ë‚˜ì˜ ì‚¬ë‘ì˜ ì–¸ì–´ëŠ”? 8ê°€ì§€ ì• ì • í‘œí˜„ ìœ í˜•ìœ¼ë¡œ ë‚˜ì™€ ì—°ì¸ì˜ ì‚¬ë‘ ì–¸ì–´ë¥¼ ì•Œì•„ë³´ê³  ê´€ê³„ë¥¼ ë”ìš± ëˆë…í•˜ê²Œ - 2-3ë¶„ ì™„ì„±'
  },
  'love-style.md': {
    newDescription: '2025ë…„ ì—°ì•  ìŠ¤íƒ€ì¼ ë¶„ì„! ë‚˜ì˜ ì—°ì•  ìœ í˜•ì€? ì—´ì •í˜•, í˜„ì‹¤í˜•, ë‚­ë§Œí˜• ë“± ë‹¤ì–‘í•œ ì—°ì•  íŒ¨í„´ì„ ì‹¬ë¦¬í•™ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” ë¬´ë£Œ ì—°ì•  í…ŒìŠ¤íŠ¸ - 2-3ë¶„ ì™„ì„±'
  },
  'mbti-simple.md': {
    newDescription: '2025ë…„ ê°„ë‹¨í•œ MBTI ì„±ê²© í…ŒìŠ¤íŠ¸! 16ê°€ì§€ ì„±ê²© ìœ í˜• ì¤‘ ë‚˜ëŠ”? ì‹¬ë¦¬í•™ ê¸°ë°˜ ì§ˆë¬¸ìœ¼ë¡œ ë¹ ë¥´ê²Œ MBTI í™•ì¸. ë¬´ë£Œ ì„±ê²© í…ŒìŠ¤íŠ¸ë¡œ ë‚˜ë¥¼ ì´í•´í•˜ì„¸ìš” - 3ë¶„ ì™„ì„±'
  },
  'self-esteem.md': {
    newDescription: '2025ë…„ ìì¡´ê° ì¸¡ì • í…ŒìŠ¤íŠ¸! ë‚˜ì˜ ìì¡´ê° ìˆ˜ì¤€ì€? ì‹¬ë¦¬í•™ ê¸°ë°˜ ì§ˆë¬¸ìœ¼ë¡œ ìì•„ì¡´ì¤‘ê°ì„ ì •í™•í•˜ê²Œ ì§„ë‹¨í•˜ê³  ê°œì„  ë°©ë²• ì œì‹œ - ë¬´ë£Œ 2ë¶„ ì™„ì„±'
  },
  'sociability.md': {
    newDescription: '2025ë…„ ì‚¬íšŒì„± í…ŒìŠ¤íŠ¸! ë‚˜ì˜ ì‚¬êµ ëŠ¥ë ¥ì€? ëŒ€ì¸ê´€ê³„ ìœ í˜•ê³¼ ì†Œí†µ ìŠ¤íƒ€ì¼ì„ ì‹¬ë¦¬í•™ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” ë¬´ë£Œ ì„±ê²© í…ŒìŠ¤íŠ¸ - 2-3ë¶„ ì™„ì„±'
  },
  'spending-style.md': {
    newDescription: '2025ë…„ ì†Œë¹„ ì„±í–¥ ë¶„ì„ í…ŒìŠ¤íŠ¸! ë‚˜ëŠ” ì ˆì•½ì™•? ì¶©ë™êµ¬ë§¤í˜•? 8ê°€ì§€ ì†Œë¹„ íŒ¨í„´ìœ¼ë¡œ ë‚˜ì˜ ëˆ ê´€ë¦¬ ìŠ¤íƒ€ì¼ì„ íŒŒì•…í•˜ê³  ì¬í…Œí¬ íŒê¹Œì§€ ë¬´ë£Œë¡œ - 2ë¶„ ì™„ì„±'
  },
  'stress-level.md': {
    newDescription: '2025ë…„ ìŠ¤íŠ¸ë ˆìŠ¤ ì§€ìˆ˜ ì¸¡ì •! ë‚˜ì˜ í˜„ì¬ ìŠ¤íŠ¸ë ˆìŠ¤ ìˆ˜ì¤€ì€? ì‹¬ë¦¬í•™ ê¸°ë°˜ ìê°€ì§„ë‹¨ìœ¼ë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ ì •ë„ë¥¼ í™•ì¸í•˜ê³  í•´ì†Œ ë°©ë²• ì œì‹œ - ë¬´ë£Œ 2ë¶„ ì™„ì„±'
  },
  'travel-bti.md': {
    newDescription: '2025ë…„ ì¸ê¸° ì—¬í–‰BTI! ë‚˜ì˜ ì—¬í–‰ ìŠ¤íƒ€ì¼ì€? ê³„íší˜•, ì¦‰í¥í˜•, í˜¸ìº‰ìŠ¤í˜• ë“± 12ê°€ì§€ ì—¬í–‰ ìœ í˜•ìœ¼ë¡œ ë‚˜ë¥¼ ë¶„ì„. ë¬´ë£Œ ì¬ë¯¸ í…ŒìŠ¤íŠ¸ - 2-3ë¶„ ì™„ì„±'
  }
};

const testsDir = path.join(__dirname, '../content/tests');
const files = fs.readdirSync(testsDir).filter(f => f.endsWith('.md') && !fs.statSync(path.join(testsDir, f)).isDirectory());

let updatedCount = 0;

files.forEach(file => {
  const filePath = path.join(testsDir, file);
  let content = fs.readFileSync(filePath, 'utf-8');

  // ë§ì¶¤ ìµœì í™”ê°€ ìˆëŠ” ê²½ìš°
  if (customOptimizations[file]) {
    const { newDescription } = customOptimizations[file];

    // description ì°¾ì•„ì„œ êµì²´
    const descRegex = /^description:\s*"(.+?)"/m;
    const match = content.match(descRegex);

    if (match && match[1] !== newDescription) {
      const oldDescription = match[1];
      content = content.replace(descRegex, `description: "${newDescription}"`);

      fs.writeFileSync(filePath, content);
      updatedCount++;

      console.log(`âœ… ${file}`);
      console.log(`   Old: ${oldDescription.substring(0, 60)}...`);
      console.log(`   New: ${newDescription.substring(0, 60)}...`);
      console.log('');
    }
  }
});

console.log(`\nğŸ‰ ì´ ${updatedCount}ê°œ í…ŒìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì™„ë£Œ!`);
console.log('\nğŸ’¡ ê°œì„  ì‚¬í•­:');
console.log('- "2025ë…„ ìµœì‹ " í‚¤ì›Œë“œ ì¶”ê°€');
console.log('- "ë¬´ë£Œ" í‚¤ì›Œë“œ ê°•ì¡°');
console.log('- "Në¶„ ì™„ì„±" ì†Œìš” ì‹œê°„ ëª…ì‹œ');
console.log('- í–‰ë™ ìœ ë„ ë¬¸êµ¬ ì¶”ê°€ ("ì¹œêµ¬ì™€ ê³µìœ ", "ë°”ë¡œ í™•ì¸")');
console.log('- SEO ì¹œí™”ì  í‚¤ì›Œë“œ ìì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜');
