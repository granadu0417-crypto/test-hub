# Google Analytics 4 (GA4) 사용 가이드

## 📋 설치 완료 내역

### ✅ 설치된 항목

**1. GA4 측정 ID 설정**
- 파일: `hugo.toml`
- 측정 ID: `G-FP3W863XX4`
- 위치: `[params]` 섹션

**2. 이벤트 추적 코드**
- 파일: `static/js/test-engine.js`
- 추가된 이벤트:
  - `test_start`: 테스트 시작 시
  - `test_complete`: 테스트 완료 시
  - `share` (Facebook): 페이스북 공유 클릭
  - `share` (Copy Link): 링크 복사 클릭

---

## 📊 GA4 대시보드 사용법

### 1. 실시간 보고서

**접속 방법**
1. https://analytics.google.com 접속
2. 왼쪽 메뉴 → **실시간**
3. 현재 접속 중인 사용자 확인

**확인 가능한 정보**
- 실시간 사용자 수
- 페이지 조회 중인 페이지
- 발생 중인 이벤트 (test_start, test_complete, share)
- 유입 경로 (카카오톡, 페이스북, 구글 등)
- 지역별 사용자 분포

**활용 팁**
```
💡 본인이 테스트를 진행하면 즉시 실시간 보고서에 표시됩니다.
   GA4 설정이 제대로 작동하는지 확인할 때 유용합니다.
```

---

### 2. 이벤트 보고서

**접속 방법**
1. 왼쪽 메뉴 → **보고서** → **참여도** → **이벤트**
2. 이벤트 이름별 통계 확인

**추적 중인 커스텀 이벤트**

#### `test_start` - 테스트 시작
```javascript
gtag('event', 'test_start', {
    test_id: 'mbti-simple',
    test_name: '간단한 MBTI 성격 테스트'
});
```

**확인 가능한 데이터:**
- 총 테스트 시작 횟수
- 테스트별 시작 횟수
- 시간대별 분포

#### `test_complete` - 테스트 완료
```javascript
gtag('event', 'test_complete', {
    test_id: 'mbti-simple',
    test_name: '간단한 MBTI 성격 테스트',
    result_type: 'ENFP',
    result_title: 'ENFP - 스파크형'
});
```

**확인 가능한 데이터:**
- 총 테스트 완료 횟수
- 완료율 (완료/시작 × 100)
- 결과별 분포 (ENFP, ISTJ 등 각 타입별 비율)

#### `share` - 공유 클릭
```javascript
gtag('event', 'share', {
    method: 'Facebook',  // or 'Copy Link'
    content_type: 'test_result',
    item_id: 'mbti-simple'
});
```

**확인 가능한 데이터:**
- 총 공유 클릭 수
- 공유 방법별 분포 (페이스북 vs 링크 복사)
- 공유율 (공유/완료 × 100)

---

### 3. 탐색 보고서 (고급 분석)

**맞춤 보고서 만들기**

**예시 1: 테스트별 완료율 분석**
```
1. 탐색 → 빈 보고서 생성
2. 측정기준: event_name, test_id
3. 측정항목: 이벤트 수
4. 필터: event_name = 'test_start' OR 'test_complete'
5. 완료율 계산 필드 추가
```

**예시 2: 결과 타입별 분포**
```
1. 탐색 → 빈 보고서 생성
2. 측정기준: result_type, result_title
3. 측정항목: 이벤트 수
4. 필터: event_name = 'test_complete'
5. 파이 차트로 시각화
```

**예시 3: 시간대별 트래픽 분석**
```
1. 탐색 → 빈 보고서 생성
2. 측정기준: 시간 (Hour)
3. 측정항목: 활성 사용자 수
4. 라인 차트로 시각화
```

---

## ⚠️ 주의사항 & 제한사항

### 1. 데이터 반영 시간

**실시간 데이터**
- ⚡ 즉시 반영 (5초 이내)
- 보고서: 실시간 보고서

**표준 보고서 데이터**
- ⏰ 24-48시간 소요
- 보고서: 참여도, 획득, 수익화 등

**주의**
```
⚠️ 커스텀 이벤트 (test_start, test_complete, share)는 
   실시간으로는 보이지만, 집계 보고서에는 24시간 후부터 나타납니다.
```

---

### 2. 개인정보 보호

**저장되지 않는 정보**
- ❌ 개인 식별 정보 (이름, 이메일, 전화번호)
- ❌ IP 주소 (익명화됨)
- ❌ 테스트 답변 내용

**저장되는 정보**
- ✅ 익명 사용자 ID
- ✅ 이벤트 발생 시간
- ✅ 테스트 종류 및 결과 타입
- ✅ 유입 경로 및 디바이스 정보

---

### 3. GA4 정책 준수

**반드시 지켜야 할 사항**
1. **개인정보처리방침 명시**
   - 사이트에 GA4 사용 명시 필요
   - 쿠키 사용 고지 필요

2. **금지된 데이터 전송 금지**
   - 개인 식별 정보 절대 전송 금지
   - 민감한 개인정보 전송 금지

3. **데이터 보유 기간 설정**
   - GA4 설정 → 데이터 설정 → 데이터 보관
   - 기본: 2개월 / 최대: 14개월

---

## 🎯 활용 시나리오

### 시나리오 1: 인기 테스트 파악

**목적:** 어떤 테스트가 가장 인기 있는지 확인

**방법:**
1. 이벤트 보고서 → `test_start` 이벤트 선택
2. 보조 측정기준: `test_id`
3. 정렬: 이벤트 수 내림차순

**활용:**
- 인기 테스트를 홈페이지 상단에 배치
- 비슷한 스타일의 테스트 추가 개발
- 인기 없는 테스트 개선 또는 삭제

---

### 시나리오 2: 완료율 개선

**목적:** 테스트를 시작했지만 완료하지 않는 사용자 줄이기

**분석:**
```
완료율 = (test_complete 수 / test_start 수) × 100

예시:
- test_start: 1000명
- test_complete: 700명
- 완료율: 70%
```

**개선 방안:**
- 완료율 < 60%: 질문이 너무 많거나 어려움
- 완료율 60-80%: 정상 범위
- 완료율 > 80%: 매우 좋음

---

### 시나리오 3: 바이럴 효과 측정

**목적:** 공유 기능이 실제로 바이럴에 기여하는지 확인

**분석:**
```
공유율 = (share 이벤트 수 / test_complete 수) × 100

예시:
- test_complete: 1000명
- share (Facebook): 150명
- share (Copy Link): 250명
- 총 공유: 400명
- 공유율: 40%
```

**벤치마크:**
- 공유율 < 10%: 공유 버튼 개선 필요
- 공유율 10-30%: 정상 범위
- 공유율 > 30%: 매우 좋음 (바이럴 가능성 높음)

---

### 시나리오 4: 유입 경로 최적화

**목적:** 어디서 사용자가 유입되는지 파악하여 마케팅 최적화

**확인 방법:**
1. 획득 보고서 → 트래픽 획득
2. 세션 소스/매체 확인

**주요 유입 경로:**
- `(direct) / (none)`: 직접 접속 (북마크, URL 직접 입력)
- `google / organic`: 구글 검색
- `kakaotalk.com / referral`: 카카오톡 공유
- `facebook.com / referral`: 페이스북 공유
- `m.search.naver.com / referral`: 네이버 검색

**활용:**
- 카카오톡 유입 많음 → OG 태그 최적화
- 구글 유입 적음 → SEO 개선 필요
- 직접 유입 많음 → 재방문율 높음 (긍정적)

---

## 🚀 고급 활용법

### 1. 맞춤 대시보드 생성

**추천 대시보드 구성:**
1. **일일 핵심 지표**
   - 총 방문자
   - test_start 이벤트 수
   - test_complete 이벤트 수
   - 완료율 (계산 필드)

2. **테스트별 성과**
   - 테스트별 시작 횟수
   - 테스트별 완료 횟수
   - 테스트별 완료율

3. **바이럴 지표**
   - 총 공유 수
   - 공유 방법별 분포
   - 공유율

---

### 2. 목표 설정

**전환 이벤트 설정:**
1. 관리 → 이벤트 → 전환 이벤트로 표시
2. `test_complete` 이벤트를 전환으로 설정
3. 전환 추적 시작

**활용:**
- 일일 전환 수 모니터링
- 전환 경로 분석
- 캠페인 효과 측정

---

### 3. 세그먼트 생성

**유용한 세그먼트:**

**높은 참여도 사용자**
```
조건:
- test_complete 이벤트 발생
- share 이벤트 발생
```

**이탈 사용자**
```
조건:
- test_start 이벤트 발생
- test_complete 이벤트 미발생
```

**단골 사용자**
```
조건:
- 세션 수 >= 3
- 활성 사용자
```

---

## 📝 체크리스트

### 일일 체크 (오전 9시 추천)
- [ ] 실시간 사용자 수 확인
- [ ] 전날 총 방문자 수 확인
- [ ] 이상 트래픽 또는 오류 확인

### 주간 체크 (매주 월요일)
- [ ] 지난주 총 테스트 시작/완료 수
- [ ] 테스트별 인기 순위
- [ ] 완료율 추이
- [ ] 유입 경로 변화

### 월간 체크 (매월 1일)
- [ ] 월간 성장률 (방문자, 테스트 완료 수)
- [ ] 가장 성공한 테스트 선정
- [ ] 개선 필요한 테스트 선정
- [ ] 다음 달 테스트 기획

---

## ⚙️ 설정 권장사항

### 데이터 보관 기간
- **설정:** 14개월 (최대)
- **위치:** 관리 → 데이터 설정 → 데이터 보관

### 데이터 스트림
- **이름:** natest.kr
- **URL:** https://natest.kr
- **향상된 측정:** 모두 켜기 ✅

### 맞춤 정의
1. **완료율** (계산 필드)
   ```
   (test_complete 수 / test_start 수) × 100
   ```

2. **공유율** (계산 필드)
   ```
   (share 이벤트 수 / test_complete 수) × 100
   ```

---

## 🆘 문제 해결

### Q: 이벤트가 보이지 않아요

**확인 사항:**
1. **배포 확인**
   - GitHub에 푸시 완료?
   - Cloudflare Pages 빌드 성공?

2. **코드 확인**
   - 개발자 도구(F12) → Network 탭
   - `google-analytics.com/g/collect` 요청 확인

3. **실시간 보고서**
   - 본인이 직접 테스트 진행
   - 5초 내 실시간 보고서에 표시되어야 함

### Q: 데이터가 너무 적어요

**원인 & 해결:**
- **유입 경로 부족** → SNS 공유, SEO 최적화
- **완료율 낮음** → 테스트 개선 (질문 수, 난이도)
- **공유 버튼 클릭률 낮음** → UI 개선, 인센티브 제공

### Q: 비정상적인 트래픽이 보여요

**확인:**
1. **봇 트래픽 필터링**
   - 관리 → 데이터 스트림 → 향상된 측정
   - "알려진 봇 및 스파이더" 제외 ✅

2. **이상 패턴 분석**
   - 특정 IP 반복 접속
   - 비정상적인 이벤트 순서

---

*작성일: 2025-01-23*  
*GA4 측정 ID: G-FP3W863XX4*  
*다음 업데이트: 첫 주간 데이터 수집 후*
